# JARVIS

An Intelligent Network Intrusion Detection and Prevention System powered by Machine Learning and [Snort](https://www.snort.org/)

The objective of JARVIS is to detect malicious patterns in real-time traffic data and take
action by dynamically updating Snort rules. By deploying a machine learning model (Random Forest) in parallel and dynamically enabling rules, the resource consumption of Snort can be reduced and optimized.
The model detects any attacks and suggests rules that can be deployed on Snort to prevent the
attack.

## Implementation

### Input Module

The input module is responsible for extracting traffic data and providing it to the machine learning model in the expected format.
With the help of [Tshark](https://tshark.dev/), live packet capture is done to capture all the network packets that pass through the Snort machine.
The generated packets are then sent to [CICFlowMeter](https://github.com/ahlashkari/CICFlowMeter) to extract features and statistical information for each flow present in the traffic data. 

### Machine Learning Module
This module deals with the training and testing of the Machine Learning Model, which is used for Intrusion Detection.
#### Dataset
The [CICIDS 2017 Dataset](https://www.unb.ca/cic/datasets/ids-2017.html) for Intrusion Detection was used to train the model. The Dataset consists of normal network traffic as well as simulated attacks over seven days. Each row of the dataset consists of features for a single network flow generated by CICFlowMeter. In addition to the CICIDS Dataset, data from different sources and simulated data for different classes were added. The modified dataset had a total of 2973635 rows belonging to 15 classes. The dataset has a total of 69 features that are provided by CICFlowMeter.


#### Model 
A Random Forest Classifier was trained on the Dataset mentioned above. The RandomForest implementation from the SciKit Learn library was used for implementation. The number of Decision Trees in the forest was set to 10, and each Tree was allowed to grow till the Leaf Node, i.e. max depth. Random Forest Classifier was chosen as it is resistant to class imbalance, which is highly prevalent in the CICIDS dataset. It is also less prone to overfitting, thus yielding better results.
The below table shows the results achieved by the model
|Class|Accuracy|
|-----|--------|
|Benign|0.9707784153378457|
|Bot|0.9683333333333334|
|DDoS|0.971958956685204|
|DoS GoldenEye|0.9661726804123711|
|DoS Hulk|0.9716345534909668|
|DoS Slowhttptest|0.968129885748647|
|DoS slowloris|0.9677790563866513|
|FTP-Patator|0.9671302149178256|
|Heartbleed|1.0|
|Infiltration|1.0|
|PortScan|0.971979788700046|
|SSH-Patator|0.9669327251995439|
|Web Attack Brute Force|0.958904109589041|
|Web Attack XSS|0.9685863874345549|
|Web Attack SQL Injection|1.0|


### Website Module
The website module consists of a Web-Based Dashboard for the admin to visualize data and take necessary actions. The front end was implemented using the React.js framework and was served using a Flask backend. The backend has various functionalities such as providing the list of detected attacks, providing the list of Snort Rules and Custom Rules, and providing various information such as Recently visited websites, Network Traffic, etc. These are provided as REST API endpoints using Flask, which the front end can then retrieve and display on the website.

The below figures show various aspects of the website.

![image4](https://github.com/pranavh4/Jarvis/assets/45517185/8087bfef-939d-4cb7-9eb2-5cf65206b27d)

![image3](https://github.com/pranavh4/Jarvis/assets/45517185/87aee122-c87b-4984-a1ad-eded9ae6a2d1)


### Snort Module
Snort is deployed based on the different rules present in the rules configuration file. The suggested rules provided on the website are added to the local rules configuration file, and snort is deployed again based on the new rules.



